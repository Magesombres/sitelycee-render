{"version":3,"file":"static/js/729.3c41c08a.chunk.js","mappings":"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","sources":["settings.js","../node_modules/@tanstack/query-core/src/queryObserver.ts","../node_modules/@babel/runtime/helpers/esm/objectDestructuringEmpty.js","../node_modules/@tanstack/react-query/src/QueryErrorResetBoundary.tsx","../node_modules/@tanstack/react-query/src/IsRestoringProvider.ts","../node_modules/@tanstack/react-query/src/suspense.ts","../node_modules/@tanstack/react-query/src/useBaseQuery.ts","../node_modules/@tanstack/react-query/src/errorBoundaryUtils.ts","../node_modules/@tanstack/react-query/src/useQuery.ts","hooks/useAuth.js","utils/calendar.js","components/Events.js","components/MediaUpload.js"],"sourcesContent":["import React, { createContext, useContext, useEffect, useMemo, useState } from 'react';\r\n\r\nconst STORAGE_KEY = 'appSettings:v1';\r\n\r\nexport const defaultSettings = {\r\n  theme: {\r\n    mode: 'system', // 'system' | 'light' | 'dark'\r\n  },\r\n  ui: {\r\n    pxPerMin: 1.2,\r\n    dayMinW: 240,\r\n    hoursColW: 72,\r\n    colGap: 8,\r\n    colPad: 6,\r\n    slotHoverMinH: 128,\r\n    monthCellH: 120,     // <- nouveau (optionnel)\r\n    monthCellPad: 6,     // <- nouveau (optionnel)\r\n  },\r\n  schedule: {\r\n    days: 5,\r\n    timeStart: '08:00',\r\n    timeEnd: '19:00',\r\n    showNowLine: true,\r\n  },\r\n  events: {\r\n    days: 7,\r\n  },\r\n  ab: {\r\n    // base Monday/date et type sont déjà gérés dans Schedule via localStorage\r\n  },\r\n};\r\n\r\nexport const settingsSchema = {\r\n  theme: {\r\n    mode: { type: 'enum', options: ['system', 'light', 'dark'], label: 'Thème' },\r\n  },\r\n  ui: {\r\n    pxPerMin: { type: 'number', min: 0.8, max: 3, step: 0.1, label: 'Densité verticale (px/min)' },\r\n    dayMinW: { type: 'number', min: 160, max: 420, step: 10, label: 'Largeur min d’un jour (px)' },\r\n    hoursColW: { type: 'number', min: 56, max: 120, step: 2, label: 'Largeur colonne heures (px)' },\r\n    colGap: { type: 'number', min: 0, max: 24, step: 1, label: 'Espace entre colonnes (px)' },\r\n    colPad: { type: 'number', min: 0, max: 16, step: 1, label: 'Padding interne colonne (px)' },\r\n  },\r\n  schedule: {\r\n    timeStart: { type: 'time', label: 'Heure début' },\r\n    timeEnd: { type: 'time', label: 'Heure fin' },\r\n    showNowLine: { type: 'boolean', label: 'Afficher la ligne “maintenant”' },\r\n  },\r\n  events: {\r\n    // prêt pour plus tard\r\n  },\r\n};\r\n\r\nfunction deepMerge(base, patch) {\r\n  const out = Array.isArray(base) ? [...base] : { ...base };\r\n  for (const k of Object.keys(patch || {})) {\r\n    const v = patch[k];\r\n    if (v && typeof v === 'object' && !Array.isArray(v)) {\r\n      out[k] = deepMerge(base?.[k] || {}, v);\r\n    } else {\r\n      out[k] = v;\r\n    }\r\n  }\r\n  return out;\r\n}\r\n\r\nfunction loadSettings() {\r\n  try {\r\n    const raw = localStorage.getItem(STORAGE_KEY);\r\n    if (!raw) return defaultSettings;\r\n    const parsed = JSON.parse(raw);\r\n    return deepMerge(defaultSettings, parsed);\r\n  } catch {\r\n    return defaultSettings;\r\n  }\r\n}\r\n\r\nfunction saveSettings(s) {\r\n  try {\r\n    localStorage.setItem(STORAGE_KEY, JSON.stringify(s));\r\n  } catch {}\r\n}\r\n\r\nconst SettingsContext = createContext({\r\n  settings: defaultSettings,\r\n  updateSettings: () => {},\r\n});\r\n\r\nexport function SettingsProvider({ children }) {\r\n  const [settings, setSettings] = useState(loadSettings);\r\n\r\n  const updateSettings = (patch) => {\r\n    setSettings((prev) => {\r\n      const next = deepMerge(prev, patch);\r\n      saveSettings(next);\r\n      return next;\r\n    });\r\n  };\r\n\r\n  // Thème (optionnel): pose un data-theme pour usage futur en CSS\r\n  useEffect(() => {\r\n    const root = document.documentElement;\r\n    const { mode } = settings.theme || {};\r\n    if (mode === 'light' || mode === 'dark') {\r\n      root.setAttribute('data-theme', mode);\r\n    } else {\r\n      root.removeAttribute('data-theme'); // laisse prefers-color-scheme\r\n    }\r\n  }, [settings.theme?.mode]);\r\n\r\n  const value = useMemo(() => ({ settings, updateSettings }), [settings]);\r\n  return <SettingsContext.Provider value={value}>{children}</SettingsContext.Provider>;\r\n}\r\n\r\nexport function useSettings() {\r\n  return useContext(SettingsContext);\r\n}\r\n\r\n// Utilitaires temps\r\nexport function timeToMin(t) {\r\n  if (!t || typeof t !== 'string') return undefined;\r\n  const [h, m] = t.split(':').map(Number);\r\n  if (Number.isNaN(h) || Number.isNaN(m)) return undefined;\r\n  return h * 60 + m;\r\n}\r\n\r\n// Variables CSS pour l’UI (à poser sur un wrapper via style={cssVars(settings)})\r\nexport function cssVars(s) {\r\n  const ui = s?.ui || {};\r\n  const toNum = (v, d) => (typeof v === 'number' && !Number.isNaN(v) ? v : d);\r\n\r\n  const pxPerMin = toNum(ui.pxPerMin, 1.2);\r\n  const hoursColW = toNum(ui.hoursColW, 72);\r\n  const dayMinW = toNum(ui.dayMinW, 240);\r\n  const colGap = toNum(ui.colGap, 8);\r\n  const colPad = toNum(ui.colPad, 6);\r\n  const slotHoverMinH = toNum(ui.slotHoverMinH, 128);\r\n  const monthCellH = toNum(ui.monthCellH, 120);\r\n  const monthCellPad = toNum(ui.monthCellPad, 6);\r\n\r\n  return {\r\n    '--px-per-min': String(pxPerMin),\r\n    '--hours-col-w': `${hoursColW}px`,\r\n    '--day-min-w': `${dayMinW}px`,\r\n    '--col-gap': `${colGap}px`,\r\n    '--col-pad': `${colPad}px`,\r\n    '--slot-hover-min-h': `${slotHoverMinH}px`,\r\n    '--month-cell-h': `${monthCellH}px`,\r\n    '--month-cell-pad': `${monthCellPad}px`,\r\n  };\r\n}","import { focusManager } from './focusManager'\nimport { notifyManager } from './notifyManager'\nimport { fetchState } from './query'\nimport { Subscribable } from './subscribable'\nimport { pendingThenable } from './thenable'\nimport {\n  isServer,\n  isValidTimeout,\n  noop,\n  replaceData,\n  resolveEnabled,\n  resolveStaleTime,\n  shallowEqualObjects,\n  timeUntilStale,\n} from './utils'\nimport { timeoutManager } from './timeoutManager'\nimport type { ManagedTimerId } from './timeoutManager'\nimport type { FetchOptions, Query, QueryState } from './query'\nimport type { QueryClient } from './queryClient'\nimport type { PendingThenable, Thenable } from './thenable'\nimport type {\n  DefaultError,\n  DefaultedQueryObserverOptions,\n  PlaceholderDataFunction,\n  QueryKey,\n  QueryObserverBaseResult,\n  QueryObserverOptions,\n  QueryObserverResult,\n  QueryOptions,\n  RefetchOptions,\n} from './types'\n\ntype QueryObserverListener<TData, TError> = (\n  result: QueryObserverResult<TData, TError>,\n) => void\n\ninterface ObserverFetchOptions extends FetchOptions {\n  throwOnError?: boolean\n}\n\nexport class QueryObserver<\n  TQueryFnData = unknown,\n  TError = DefaultError,\n  TData = TQueryFnData,\n  TQueryData = TQueryFnData,\n  TQueryKey extends QueryKey = QueryKey,\n> extends Subscribable<QueryObserverListener<TData, TError>> {\n  #client: QueryClient\n  #currentQuery: Query<TQueryFnData, TError, TQueryData, TQueryKey> = undefined!\n  #currentQueryInitialState: QueryState<TQueryData, TError> = undefined!\n  #currentResult: QueryObserverResult<TData, TError> = undefined!\n  #currentResultState?: QueryState<TQueryData, TError>\n  #currentResultOptions?: QueryObserverOptions<\n    TQueryFnData,\n    TError,\n    TData,\n    TQueryData,\n    TQueryKey\n  >\n  #currentThenable: Thenable<TData>\n  #selectError: TError | null\n  #selectFn?: (data: TQueryData) => TData\n  #selectResult?: TData\n  // This property keeps track of the last query with defined data.\n  // It will be used to pass the previous data and query to the placeholder function between renders.\n  #lastQueryWithDefinedData?: Query<TQueryFnData, TError, TQueryData, TQueryKey>\n  #staleTimeoutId?: ManagedTimerId\n  #refetchIntervalId?: ManagedTimerId\n  #currentRefetchInterval?: number | false\n  #trackedProps = new Set<keyof QueryObserverResult>()\n\n  constructor(\n    client: QueryClient,\n    public options: QueryObserverOptions<\n      TQueryFnData,\n      TError,\n      TData,\n      TQueryData,\n      TQueryKey\n    >,\n  ) {\n    super()\n\n    this.#client = client\n    this.#selectError = null\n    this.#currentThenable = pendingThenable()\n\n    this.bindMethods()\n    this.setOptions(options)\n  }\n\n  protected bindMethods(): void {\n    this.refetch = this.refetch.bind(this)\n  }\n\n  protected onSubscribe(): void {\n    if (this.listeners.size === 1) {\n      this.#currentQuery.addObserver(this)\n\n      if (shouldFetchOnMount(this.#currentQuery, this.options)) {\n        this.#executeFetch()\n      } else {\n        this.updateResult()\n      }\n\n      this.#updateTimers()\n    }\n  }\n\n  protected onUnsubscribe(): void {\n    if (!this.hasListeners()) {\n      this.destroy()\n    }\n  }\n\n  shouldFetchOnReconnect(): boolean {\n    return shouldFetchOn(\n      this.#currentQuery,\n      this.options,\n      this.options.refetchOnReconnect,\n    )\n  }\n\n  shouldFetchOnWindowFocus(): boolean {\n    return shouldFetchOn(\n      this.#currentQuery,\n      this.options,\n      this.options.refetchOnWindowFocus,\n    )\n  }\n\n  destroy(): void {\n    this.listeners = new Set()\n    this.#clearStaleTimeout()\n    this.#clearRefetchInterval()\n    this.#currentQuery.removeObserver(this)\n  }\n\n  setOptions(\n    options: QueryObserverOptions<\n      TQueryFnData,\n      TError,\n      TData,\n      TQueryData,\n      TQueryKey\n    >,\n  ): void {\n    const prevOptions = this.options\n    const prevQuery = this.#currentQuery\n\n    this.options = this.#client.defaultQueryOptions(options)\n\n    if (\n      this.options.enabled !== undefined &&\n      typeof this.options.enabled !== 'boolean' &&\n      typeof this.options.enabled !== 'function' &&\n      typeof resolveEnabled(this.options.enabled, this.#currentQuery) !==\n        'boolean'\n    ) {\n      throw new Error(\n        'Expected enabled to be a boolean or a callback that returns a boolean',\n      )\n    }\n\n    this.#updateQuery()\n    this.#currentQuery.setOptions(this.options)\n\n    if (\n      prevOptions._defaulted &&\n      !shallowEqualObjects(this.options, prevOptions)\n    ) {\n      this.#client.getQueryCache().notify({\n        type: 'observerOptionsUpdated',\n        query: this.#currentQuery,\n        observer: this,\n      })\n    }\n\n    const mounted = this.hasListeners()\n\n    // Fetch if there are subscribers\n    if (\n      mounted &&\n      shouldFetchOptionally(\n        this.#currentQuery,\n        prevQuery,\n        this.options,\n        prevOptions,\n      )\n    ) {\n      this.#executeFetch()\n    }\n\n    // Update result\n    this.updateResult()\n\n    // Update stale interval if needed\n    if (\n      mounted &&\n      (this.#currentQuery !== prevQuery ||\n        resolveEnabled(this.options.enabled, this.#currentQuery) !==\n          resolveEnabled(prevOptions.enabled, this.#currentQuery) ||\n        resolveStaleTime(this.options.staleTime, this.#currentQuery) !==\n          resolveStaleTime(prevOptions.staleTime, this.#currentQuery))\n    ) {\n      this.#updateStaleTimeout()\n    }\n\n    const nextRefetchInterval = this.#computeRefetchInterval()\n\n    // Update refetch interval if needed\n    if (\n      mounted &&\n      (this.#currentQuery !== prevQuery ||\n        resolveEnabled(this.options.enabled, this.#currentQuery) !==\n          resolveEnabled(prevOptions.enabled, this.#currentQuery) ||\n        nextRefetchInterval !== this.#currentRefetchInterval)\n    ) {\n      this.#updateRefetchInterval(nextRefetchInterval)\n    }\n  }\n\n  getOptimisticResult(\n    options: DefaultedQueryObserverOptions<\n      TQueryFnData,\n      TError,\n      TData,\n      TQueryData,\n      TQueryKey\n    >,\n  ): QueryObserverResult<TData, TError> {\n    const query = this.#client.getQueryCache().build(this.#client, options)\n\n    const result = this.createResult(query, options)\n\n    if (shouldAssignObserverCurrentProperties(this, result)) {\n      // this assigns the optimistic result to the current Observer\n      // because if the query function changes, useQuery will be performing\n      // an effect where it would fetch again.\n      // When the fetch finishes, we perform a deep data cloning in order\n      // to reuse objects references. This deep data clone is performed against\n      // the `observer.currentResult.data` property\n      // When QueryKey changes, we refresh the query and get new `optimistic`\n      // result, while we leave the `observer.currentResult`, so when new data\n      // arrives, it finds the old `observer.currentResult` which is related\n      // to the old QueryKey. Which means that currentResult and selectData are\n      // out of sync already.\n      // To solve this, we move the cursor of the currentResult every time\n      // an observer reads an optimistic value.\n\n      // When keeping the previous data, the result doesn't change until new\n      // data arrives.\n      this.#currentResult = result\n      this.#currentResultOptions = this.options\n      this.#currentResultState = this.#currentQuery.state\n    }\n    return result\n  }\n\n  getCurrentResult(): QueryObserverResult<TData, TError> {\n    return this.#currentResult\n  }\n\n  trackResult(\n    result: QueryObserverResult<TData, TError>,\n    onPropTracked?: (key: keyof QueryObserverResult) => void,\n  ): QueryObserverResult<TData, TError> {\n    return new Proxy(result, {\n      get: (target, key) => {\n        this.trackProp(key as keyof QueryObserverResult)\n        onPropTracked?.(key as keyof QueryObserverResult)\n        if (\n          key === 'promise' &&\n          !this.options.experimental_prefetchInRender &&\n          this.#currentThenable.status === 'pending'\n        ) {\n          this.#currentThenable.reject(\n            new Error(\n              'experimental_prefetchInRender feature flag is not enabled',\n            ),\n          )\n        }\n        return Reflect.get(target, key)\n      },\n    })\n  }\n\n  trackProp(key: keyof QueryObserverResult) {\n    this.#trackedProps.add(key)\n  }\n\n  getCurrentQuery(): Query<TQueryFnData, TError, TQueryData, TQueryKey> {\n    return this.#currentQuery\n  }\n\n  refetch({ ...options }: RefetchOptions = {}): Promise<\n    QueryObserverResult<TData, TError>\n  > {\n    return this.fetch({\n      ...options,\n    })\n  }\n\n  fetchOptimistic(\n    options: QueryObserverOptions<\n      TQueryFnData,\n      TError,\n      TData,\n      TQueryData,\n      TQueryKey\n    >,\n  ): Promise<QueryObserverResult<TData, TError>> {\n    const defaultedOptions = this.#client.defaultQueryOptions(options)\n\n    const query = this.#client\n      .getQueryCache()\n      .build(this.#client, defaultedOptions)\n\n    return query.fetch().then(() => this.createResult(query, defaultedOptions))\n  }\n\n  protected fetch(\n    fetchOptions: ObserverFetchOptions,\n  ): Promise<QueryObserverResult<TData, TError>> {\n    return this.#executeFetch({\n      ...fetchOptions,\n      cancelRefetch: fetchOptions.cancelRefetch ?? true,\n    }).then(() => {\n      this.updateResult()\n      return this.#currentResult\n    })\n  }\n\n  #executeFetch(\n    fetchOptions?: Omit<ObserverFetchOptions, 'initialPromise'>,\n  ): Promise<TQueryData | undefined> {\n    // Make sure we reference the latest query as the current one might have been removed\n    this.#updateQuery()\n\n    // Fetch\n    let promise: Promise<TQueryData | undefined> = this.#currentQuery.fetch(\n      this.options as QueryOptions<TQueryFnData, TError, TQueryData, TQueryKey>,\n      fetchOptions,\n    )\n\n    if (!fetchOptions?.throwOnError) {\n      promise = promise.catch(noop)\n    }\n\n    return promise\n  }\n\n  #updateStaleTimeout(): void {\n    this.#clearStaleTimeout()\n    const staleTime = resolveStaleTime(\n      this.options.staleTime,\n      this.#currentQuery,\n    )\n\n    if (isServer || this.#currentResult.isStale || !isValidTimeout(staleTime)) {\n      return\n    }\n\n    const time = timeUntilStale(this.#currentResult.dataUpdatedAt, staleTime)\n\n    // The timeout is sometimes triggered 1 ms before the stale time expiration.\n    // To mitigate this issue we always add 1 ms to the timeout.\n    const timeout = time + 1\n\n    this.#staleTimeoutId = timeoutManager.setTimeout(() => {\n      if (!this.#currentResult.isStale) {\n        this.updateResult()\n      }\n    }, timeout)\n  }\n\n  #computeRefetchInterval() {\n    return (\n      (typeof this.options.refetchInterval === 'function'\n        ? this.options.refetchInterval(this.#currentQuery)\n        : this.options.refetchInterval) ?? false\n    )\n  }\n\n  #updateRefetchInterval(nextInterval: number | false): void {\n    this.#clearRefetchInterval()\n\n    this.#currentRefetchInterval = nextInterval\n\n    if (\n      isServer ||\n      resolveEnabled(this.options.enabled, this.#currentQuery) === false ||\n      !isValidTimeout(this.#currentRefetchInterval) ||\n      this.#currentRefetchInterval === 0\n    ) {\n      return\n    }\n\n    this.#refetchIntervalId = timeoutManager.setInterval(() => {\n      if (\n        this.options.refetchIntervalInBackground ||\n        focusManager.isFocused()\n      ) {\n        this.#executeFetch()\n      }\n    }, this.#currentRefetchInterval)\n  }\n\n  #updateTimers(): void {\n    this.#updateStaleTimeout()\n    this.#updateRefetchInterval(this.#computeRefetchInterval())\n  }\n\n  #clearStaleTimeout(): void {\n    if (this.#staleTimeoutId) {\n      timeoutManager.clearTimeout(this.#staleTimeoutId)\n      this.#staleTimeoutId = undefined\n    }\n  }\n\n  #clearRefetchInterval(): void {\n    if (this.#refetchIntervalId) {\n      timeoutManager.clearInterval(this.#refetchIntervalId)\n      this.#refetchIntervalId = undefined\n    }\n  }\n\n  protected createResult(\n    query: Query<TQueryFnData, TError, TQueryData, TQueryKey>,\n    options: QueryObserverOptions<\n      TQueryFnData,\n      TError,\n      TData,\n      TQueryData,\n      TQueryKey\n    >,\n  ): QueryObserverResult<TData, TError> {\n    const prevQuery = this.#currentQuery\n    const prevOptions = this.options\n    const prevResult = this.#currentResult as\n      | QueryObserverResult<TData, TError>\n      | undefined\n    const prevResultState = this.#currentResultState\n    const prevResultOptions = this.#currentResultOptions\n    const queryChange = query !== prevQuery\n    const queryInitialState = queryChange\n      ? query.state\n      : this.#currentQueryInitialState\n\n    const { state } = query\n    let newState = { ...state }\n    let isPlaceholderData = false\n    let data: TData | undefined\n\n    // Optimistically set result in fetching state if needed\n    if (options._optimisticResults) {\n      const mounted = this.hasListeners()\n\n      const fetchOnMount = !mounted && shouldFetchOnMount(query, options)\n\n      const fetchOptionally =\n        mounted && shouldFetchOptionally(query, prevQuery, options, prevOptions)\n\n      if (fetchOnMount || fetchOptionally) {\n        newState = {\n          ...newState,\n          ...fetchState(state.data, query.options),\n        }\n      }\n      if (options._optimisticResults === 'isRestoring') {\n        newState.fetchStatus = 'idle'\n      }\n    }\n\n    let { error, errorUpdatedAt, status } = newState\n\n    // Per default, use query data\n    data = newState.data as unknown as TData\n    let skipSelect = false\n\n    // use placeholderData if needed\n    if (\n      options.placeholderData !== undefined &&\n      data === undefined &&\n      status === 'pending'\n    ) {\n      let placeholderData\n\n      // Memoize placeholder data\n      if (\n        prevResult?.isPlaceholderData &&\n        options.placeholderData === prevResultOptions?.placeholderData\n      ) {\n        placeholderData = prevResult.data\n        // we have to skip select when reading this memoization\n        // because prevResult.data is already \"selected\"\n        skipSelect = true\n      } else {\n        // compute placeholderData\n        placeholderData =\n          typeof options.placeholderData === 'function'\n            ? (\n                options.placeholderData as unknown as PlaceholderDataFunction<TQueryData>\n              )(\n                this.#lastQueryWithDefinedData?.state.data,\n                this.#lastQueryWithDefinedData as any,\n              )\n            : options.placeholderData\n      }\n\n      if (placeholderData !== undefined) {\n        status = 'success'\n        data = replaceData(\n          prevResult?.data,\n          placeholderData as unknown,\n          options,\n        ) as TData\n        isPlaceholderData = true\n      }\n    }\n\n    // Select data if needed\n    // this also runs placeholderData through the select function\n    if (options.select && data !== undefined && !skipSelect) {\n      // Memoize select result\n      if (\n        prevResult &&\n        data === prevResultState?.data &&\n        options.select === this.#selectFn\n      ) {\n        data = this.#selectResult\n      } else {\n        try {\n          this.#selectFn = options.select\n          data = options.select(data as any)\n          data = replaceData(prevResult?.data, data, options)\n          this.#selectResult = data\n          this.#selectError = null\n        } catch (selectError) {\n          this.#selectError = selectError as TError\n        }\n      }\n    }\n\n    if (this.#selectError) {\n      error = this.#selectError as any\n      data = this.#selectResult\n      errorUpdatedAt = Date.now()\n      status = 'error'\n    }\n\n    const isFetching = newState.fetchStatus === 'fetching'\n    const isPending = status === 'pending'\n    const isError = status === 'error'\n\n    const isLoading = isPending && isFetching\n    const hasData = data !== undefined\n\n    const result: QueryObserverBaseResult<TData, TError> = {\n      status,\n      fetchStatus: newState.fetchStatus,\n      isPending,\n      isSuccess: status === 'success',\n      isError,\n      isInitialLoading: isLoading,\n      isLoading,\n      data,\n      dataUpdatedAt: newState.dataUpdatedAt,\n      error,\n      errorUpdatedAt,\n      failureCount: newState.fetchFailureCount,\n      failureReason: newState.fetchFailureReason,\n      errorUpdateCount: newState.errorUpdateCount,\n      isFetched: newState.dataUpdateCount > 0 || newState.errorUpdateCount > 0,\n      isFetchedAfterMount:\n        newState.dataUpdateCount > queryInitialState.dataUpdateCount ||\n        newState.errorUpdateCount > queryInitialState.errorUpdateCount,\n      isFetching,\n      isRefetching: isFetching && !isPending,\n      isLoadingError: isError && !hasData,\n      isPaused: newState.fetchStatus === 'paused',\n      isPlaceholderData,\n      isRefetchError: isError && hasData,\n      isStale: isStale(query, options),\n      refetch: this.refetch,\n      promise: this.#currentThenable,\n      isEnabled: resolveEnabled(options.enabled, query) !== false,\n    }\n\n    const nextResult = result as QueryObserverResult<TData, TError>\n\n    if (this.options.experimental_prefetchInRender) {\n      const finalizeThenableIfPossible = (thenable: PendingThenable<TData>) => {\n        if (nextResult.status === 'error') {\n          thenable.reject(nextResult.error)\n        } else if (nextResult.data !== undefined) {\n          thenable.resolve(nextResult.data)\n        }\n      }\n\n      /**\n       * Create a new thenable and result promise when the results have changed\n       */\n      const recreateThenable = () => {\n        const pending =\n          (this.#currentThenable =\n          nextResult.promise =\n            pendingThenable())\n\n        finalizeThenableIfPossible(pending)\n      }\n\n      const prevThenable = this.#currentThenable\n      switch (prevThenable.status) {\n        case 'pending':\n          // Finalize the previous thenable if it was pending\n          // and we are still observing the same query\n          if (query.queryHash === prevQuery.queryHash) {\n            finalizeThenableIfPossible(prevThenable)\n          }\n          break\n        case 'fulfilled':\n          if (\n            nextResult.status === 'error' ||\n            nextResult.data !== prevThenable.value\n          ) {\n            recreateThenable()\n          }\n          break\n        case 'rejected':\n          if (\n            nextResult.status !== 'error' ||\n            nextResult.error !== prevThenable.reason\n          ) {\n            recreateThenable()\n          }\n          break\n      }\n    }\n\n    return nextResult\n  }\n\n  updateResult(): void {\n    const prevResult = this.#currentResult as\n      | QueryObserverResult<TData, TError>\n      | undefined\n\n    const nextResult = this.createResult(this.#currentQuery, this.options)\n\n    this.#currentResultState = this.#currentQuery.state\n    this.#currentResultOptions = this.options\n\n    if (this.#currentResultState.data !== undefined) {\n      this.#lastQueryWithDefinedData = this.#currentQuery\n    }\n\n    // Only notify and update result if something has changed\n    if (shallowEqualObjects(nextResult, prevResult)) {\n      return\n    }\n\n    this.#currentResult = nextResult\n\n    const shouldNotifyListeners = (): boolean => {\n      if (!prevResult) {\n        return true\n      }\n\n      const { notifyOnChangeProps } = this.options\n      const notifyOnChangePropsValue =\n        typeof notifyOnChangeProps === 'function'\n          ? notifyOnChangeProps()\n          : notifyOnChangeProps\n\n      if (\n        notifyOnChangePropsValue === 'all' ||\n        (!notifyOnChangePropsValue && !this.#trackedProps.size)\n      ) {\n        return true\n      }\n\n      const includedProps = new Set(\n        notifyOnChangePropsValue ?? this.#trackedProps,\n      )\n\n      if (this.options.throwOnError) {\n        includedProps.add('error')\n      }\n\n      return Object.keys(this.#currentResult).some((key) => {\n        const typedKey = key as keyof QueryObserverResult\n        const changed = this.#currentResult[typedKey] !== prevResult[typedKey]\n\n        return changed && includedProps.has(typedKey)\n      })\n    }\n\n    this.#notify({ listeners: shouldNotifyListeners() })\n  }\n\n  #updateQuery(): void {\n    const query = this.#client.getQueryCache().build(this.#client, this.options)\n\n    if (query === this.#currentQuery) {\n      return\n    }\n\n    const prevQuery = this.#currentQuery as\n      | Query<TQueryFnData, TError, TQueryData, TQueryKey>\n      | undefined\n    this.#currentQuery = query\n    this.#currentQueryInitialState = query.state\n\n    if (this.hasListeners()) {\n      prevQuery?.removeObserver(this)\n      query.addObserver(this)\n    }\n  }\n\n  onQueryUpdate(): void {\n    this.updateResult()\n\n    if (this.hasListeners()) {\n      this.#updateTimers()\n    }\n  }\n\n  #notify(notifyOptions: { listeners: boolean }): void {\n    notifyManager.batch(() => {\n      // First, trigger the listeners\n      if (notifyOptions.listeners) {\n        this.listeners.forEach((listener) => {\n          listener(this.#currentResult)\n        })\n      }\n\n      // Then the cache listeners\n      this.#client.getQueryCache().notify({\n        query: this.#currentQuery,\n        type: 'observerResultsUpdated',\n      })\n    })\n  }\n}\n\nfunction shouldLoadOnMount(\n  query: Query<any, any, any, any>,\n  options: QueryObserverOptions<any, any, any, any>,\n): boolean {\n  return (\n    resolveEnabled(options.enabled, query) !== false &&\n    query.state.data === undefined &&\n    !(query.state.status === 'error' && options.retryOnMount === false)\n  )\n}\n\nfunction shouldFetchOnMount(\n  query: Query<any, any, any, any>,\n  options: QueryObserverOptions<any, any, any, any, any>,\n): boolean {\n  return (\n    shouldLoadOnMount(query, options) ||\n    (query.state.data !== undefined &&\n      shouldFetchOn(query, options, options.refetchOnMount))\n  )\n}\n\nfunction shouldFetchOn(\n  query: Query<any, any, any, any>,\n  options: QueryObserverOptions<any, any, any, any, any>,\n  field: (typeof options)['refetchOnMount'] &\n    (typeof options)['refetchOnWindowFocus'] &\n    (typeof options)['refetchOnReconnect'],\n) {\n  if (\n    resolveEnabled(options.enabled, query) !== false &&\n    resolveStaleTime(options.staleTime, query) !== 'static'\n  ) {\n    const value = typeof field === 'function' ? field(query) : field\n\n    return value === 'always' || (value !== false && isStale(query, options))\n  }\n  return false\n}\n\nfunction shouldFetchOptionally(\n  query: Query<any, any, any, any>,\n  prevQuery: Query<any, any, any, any>,\n  options: QueryObserverOptions<any, any, any, any, any>,\n  prevOptions: QueryObserverOptions<any, any, any, any, any>,\n): boolean {\n  return (\n    (query !== prevQuery ||\n      resolveEnabled(prevOptions.enabled, query) === false) &&\n    (!options.suspense || query.state.status !== 'error') &&\n    isStale(query, options)\n  )\n}\n\nfunction isStale(\n  query: Query<any, any, any, any>,\n  options: QueryObserverOptions<any, any, any, any, any>,\n): boolean {\n  return (\n    resolveEnabled(options.enabled, query) !== false &&\n    query.isStaleByTime(resolveStaleTime(options.staleTime, query))\n  )\n}\n\n// this function would decide if we will update the observer's 'current'\n// properties after an optimistic reading via getOptimisticResult\nfunction shouldAssignObserverCurrentProperties<\n  TQueryFnData = unknown,\n  TError = unknown,\n  TData = TQueryFnData,\n  TQueryData = TQueryFnData,\n  TQueryKey extends QueryKey = QueryKey,\n>(\n  observer: QueryObserver<TQueryFnData, TError, TData, TQueryData, TQueryKey>,\n  optimisticResult: QueryObserverResult<TData, TError>,\n) {\n  // if the newly created result isn't what the observer is holding as current,\n  // then we'll need to update the properties as well\n  if (!shallowEqualObjects(observer.getCurrentResult(), optimisticResult)) {\n    return true\n  }\n\n  // basically, just keep previous properties if nothing changed\n  return false\n}\n","function _objectDestructuringEmpty(t) {\n  if (null == t) throw new TypeError(\"Cannot destructure \" + t);\n}\nexport { _objectDestructuringEmpty as default };","'use client'\nimport * as React from 'react'\n\n// CONTEXT\nexport type QueryErrorResetFunction = () => void\nexport type QueryErrorIsResetFunction = () => boolean\nexport type QueryErrorClearResetFunction = () => void\n\nexport interface QueryErrorResetBoundaryValue {\n  clearReset: QueryErrorClearResetFunction\n  isReset: QueryErrorIsResetFunction\n  reset: QueryErrorResetFunction\n}\n\nfunction createValue(): QueryErrorResetBoundaryValue {\n  let isReset = false\n  return {\n    clearReset: () => {\n      isReset = false\n    },\n    reset: () => {\n      isReset = true\n    },\n    isReset: () => {\n      return isReset\n    },\n  }\n}\n\nconst QueryErrorResetBoundaryContext = React.createContext(createValue())\n\n// HOOK\n\nexport const useQueryErrorResetBoundary = () =>\n  React.useContext(QueryErrorResetBoundaryContext)\n\n// COMPONENT\n\nexport type QueryErrorResetBoundaryFunction = (\n  value: QueryErrorResetBoundaryValue,\n) => React.ReactNode\n\nexport interface QueryErrorResetBoundaryProps {\n  children: QueryErrorResetBoundaryFunction | React.ReactNode\n}\n\nexport const QueryErrorResetBoundary = ({\n  children,\n}: QueryErrorResetBoundaryProps) => {\n  const [value] = React.useState(() => createValue())\n  return (\n    <QueryErrorResetBoundaryContext.Provider value={value}>\n      {typeof children === 'function' ? children(value) : children}\n    </QueryErrorResetBoundaryContext.Provider>\n  )\n}\n","'use client'\nimport * as React from 'react'\n\nconst IsRestoringContext = React.createContext(false)\n\nexport const useIsRestoring = () => React.useContext(IsRestoringContext)\nexport const IsRestoringProvider = IsRestoringContext.Provider\n","import type {\n  DefaultError,\n  DefaultedQueryObserverOptions,\n  Query,\n  QueryKey,\n  QueryObserver,\n  QueryObserverResult,\n} from '@tanstack/query-core'\nimport type { QueryErrorResetBoundaryValue } from './QueryErrorResetBoundary'\n\nexport const defaultThrowOnError = <\n  TQueryFnData = unknown,\n  TError = DefaultError,\n  TData = TQueryFnData,\n  TQueryKey extends QueryKey = QueryKey,\n>(\n  _error: TError,\n  query: Query<TQueryFnData, TError, TData, TQueryKey>,\n) => query.state.data === undefined\n\nexport const ensureSuspenseTimers = (\n  defaultedOptions: DefaultedQueryObserverOptions<any, any, any, any, any>,\n) => {\n  if (defaultedOptions.suspense) {\n    // Handle staleTime to ensure minimum 1000ms in Suspense mode\n    // This prevents unnecessary refetching when components remount after suspending\n    const MIN_SUSPENSE_TIME_MS = 1000\n\n    const clamp = (value: number | 'static' | undefined) =>\n      value === 'static'\n        ? value\n        : Math.max(value ?? MIN_SUSPENSE_TIME_MS, MIN_SUSPENSE_TIME_MS)\n\n    const originalStaleTime = defaultedOptions.staleTime\n    defaultedOptions.staleTime =\n      typeof originalStaleTime === 'function'\n        ? (...args) => clamp(originalStaleTime(...args))\n        : clamp(originalStaleTime)\n\n    if (typeof defaultedOptions.gcTime === 'number') {\n      defaultedOptions.gcTime = Math.max(\n        defaultedOptions.gcTime,\n        MIN_SUSPENSE_TIME_MS,\n      )\n    }\n  }\n}\n\nexport const willFetch = (\n  result: QueryObserverResult<any, any>,\n  isRestoring: boolean,\n) => result.isLoading && result.isFetching && !isRestoring\n\nexport const shouldSuspend = (\n  defaultedOptions:\n    | DefaultedQueryObserverOptions<any, any, any, any, any>\n    | undefined,\n  result: QueryObserverResult<any, any>,\n) => defaultedOptions?.suspense && result.isPending\n\nexport const fetchOptimistic = <\n  TQueryFnData,\n  TError,\n  TData,\n  TQueryData,\n  TQueryKey extends QueryKey,\n>(\n  defaultedOptions: DefaultedQueryObserverOptions<\n    TQueryFnData,\n    TError,\n    TData,\n    TQueryData,\n    TQueryKey\n  >,\n  observer: QueryObserver<TQueryFnData, TError, TData, TQueryData, TQueryKey>,\n  errorResetBoundary: QueryErrorResetBoundaryValue,\n) =>\n  observer.fetchOptimistic(defaultedOptions).catch(() => {\n    errorResetBoundary.clearReset()\n  })\n","'use client'\nimport * as React from 'react'\n\nimport { isServer, noop, notifyManager } from '@tanstack/query-core'\nimport { useQueryClient } from './QueryClientProvider'\nimport { useQueryErrorResetBoundary } from './QueryErrorResetBoundary'\nimport {\n  ensurePreventErrorBoundaryRetry,\n  getHasError,\n  useClearResetErrorBoundary,\n} from './errorBoundaryUtils'\nimport { useIsRestoring } from './IsRestoringProvider'\nimport {\n  ensureSuspenseTimers,\n  fetchOptimistic,\n  shouldSuspend,\n  willFetch,\n} from './suspense'\nimport type {\n  QueryClient,\n  QueryKey,\n  QueryObserver,\n  QueryObserverResult,\n} from '@tanstack/query-core'\nimport type { UseBaseQueryOptions } from './types'\n\nexport function useBaseQuery<\n  TQueryFnData,\n  TError,\n  TData,\n  TQueryData,\n  TQueryKey extends QueryKey,\n>(\n  options: UseBaseQueryOptions<\n    TQueryFnData,\n    TError,\n    TData,\n    TQueryData,\n    TQueryKey\n  >,\n  Observer: typeof QueryObserver,\n  queryClient?: QueryClient,\n): QueryObserverResult<TData, TError> {\n  if (process.env.NODE_ENV !== 'production') {\n    if (typeof options !== 'object' || Array.isArray(options)) {\n      throw new Error(\n        'Bad argument type. Starting with v5, only the \"Object\" form is allowed when calling query related functions. Please use the error stack to find the culprit call. More info here: https://tanstack.com/query/latest/docs/react/guides/migrating-to-v5#supports-a-single-signature-one-object',\n      )\n    }\n  }\n\n  const isRestoring = useIsRestoring()\n  const errorResetBoundary = useQueryErrorResetBoundary()\n  const client = useQueryClient(queryClient)\n  const defaultedOptions = client.defaultQueryOptions(options)\n\n  ;(client.getDefaultOptions().queries as any)?._experimental_beforeQuery?.(\n    defaultedOptions,\n  )\n\n  if (process.env.NODE_ENV !== 'production') {\n    if (!defaultedOptions.queryFn) {\n      console.error(\n        `[${defaultedOptions.queryHash}]: No queryFn was passed as an option, and no default queryFn was found. The queryFn parameter is only optional when using a default queryFn. More info here: https://tanstack.com/query/latest/docs/framework/react/guides/default-query-function`,\n      )\n    }\n  }\n\n  // Make sure results are optimistically set in fetching state before subscribing or updating options\n  defaultedOptions._optimisticResults = isRestoring\n    ? 'isRestoring'\n    : 'optimistic'\n\n  ensureSuspenseTimers(defaultedOptions)\n  ensurePreventErrorBoundaryRetry(defaultedOptions, errorResetBoundary)\n\n  useClearResetErrorBoundary(errorResetBoundary)\n\n  // this needs to be invoked before creating the Observer because that can create a cache entry\n  const isNewCacheEntry = !client\n    .getQueryCache()\n    .get(defaultedOptions.queryHash)\n\n  const [observer] = React.useState(\n    () =>\n      new Observer<TQueryFnData, TError, TData, TQueryData, TQueryKey>(\n        client,\n        defaultedOptions,\n      ),\n  )\n\n  // note: this must be called before useSyncExternalStore\n  const result = observer.getOptimisticResult(defaultedOptions)\n\n  const shouldSubscribe = !isRestoring && options.subscribed !== false\n  React.useSyncExternalStore(\n    React.useCallback(\n      (onStoreChange) => {\n        const unsubscribe = shouldSubscribe\n          ? observer.subscribe(notifyManager.batchCalls(onStoreChange))\n          : noop\n\n        // Update result to make sure we did not miss any query updates\n        // between creating the observer and subscribing to it.\n        observer.updateResult()\n\n        return unsubscribe\n      },\n      [observer, shouldSubscribe],\n    ),\n    () => observer.getCurrentResult(),\n    () => observer.getCurrentResult(),\n  )\n\n  React.useEffect(() => {\n    observer.setOptions(defaultedOptions)\n  }, [defaultedOptions, observer])\n\n  // Handle suspense\n  if (shouldSuspend(defaultedOptions, result)) {\n    throw fetchOptimistic(defaultedOptions, observer, errorResetBoundary)\n  }\n\n  // Handle error boundary\n  if (\n    getHasError({\n      result,\n      errorResetBoundary,\n      throwOnError: defaultedOptions.throwOnError,\n      query: client\n        .getQueryCache()\n        .get<\n          TQueryFnData,\n          TError,\n          TQueryData,\n          TQueryKey\n        >(defaultedOptions.queryHash),\n      suspense: defaultedOptions.suspense,\n    })\n  ) {\n    throw result.error\n  }\n\n  ;(client.getDefaultOptions().queries as any)?._experimental_afterQuery?.(\n    defaultedOptions,\n    result,\n  )\n\n  if (\n    defaultedOptions.experimental_prefetchInRender &&\n    !isServer &&\n    willFetch(result, isRestoring)\n  ) {\n    const promise = isNewCacheEntry\n      ? // Fetch immediately on render in order to ensure `.promise` is resolved even if the component is unmounted\n        fetchOptimistic(defaultedOptions, observer, errorResetBoundary)\n      : // subscribe to the \"cache promise\" so that we can finalize the currentThenable once data comes in\n        client.getQueryCache().get(defaultedOptions.queryHash)?.promise\n\n    promise?.catch(noop).finally(() => {\n      // `.updateResult()` will trigger `.#currentThenable` to finalize\n      observer.updateResult()\n    })\n  }\n\n  // Handle result property usage tracking\n  return !defaultedOptions.notifyOnChangeProps\n    ? observer.trackResult(result)\n    : result\n}\n","'use client'\nimport * as React from 'react'\nimport { shouldThrowError } from '@tanstack/query-core'\nimport type {\n  DefaultedQueryObserverOptions,\n  Query,\n  QueryKey,\n  QueryObserverResult,\n  ThrowOnError,\n} from '@tanstack/query-core'\nimport type { QueryErrorResetBoundaryValue } from './QueryErrorResetBoundary'\n\nexport const ensurePreventErrorBoundaryRetry = <\n  TQueryFnData,\n  TError,\n  TData,\n  TQueryData,\n  TQueryKey extends QueryKey,\n>(\n  options: DefaultedQueryObserverOptions<\n    TQueryFnData,\n    TError,\n    TData,\n    TQueryData,\n    TQueryKey\n  >,\n  errorResetBoundary: QueryErrorResetBoundaryValue,\n) => {\n  if (\n    options.suspense ||\n    options.throwOnError ||\n    options.experimental_prefetchInRender\n  ) {\n    // Prevent retrying failed query if the error boundary has not been reset yet\n    if (!errorResetBoundary.isReset()) {\n      options.retryOnMount = false\n    }\n  }\n}\n\nexport const useClearResetErrorBoundary = (\n  errorResetBoundary: QueryErrorResetBoundaryValue,\n) => {\n  React.useEffect(() => {\n    errorResetBoundary.clearReset()\n  }, [errorResetBoundary])\n}\n\nexport const getHasError = <\n  TData,\n  TError,\n  TQueryFnData,\n  TQueryData,\n  TQueryKey extends QueryKey,\n>({\n  result,\n  errorResetBoundary,\n  throwOnError,\n  query,\n  suspense,\n}: {\n  result: QueryObserverResult<TData, TError>\n  errorResetBoundary: QueryErrorResetBoundaryValue\n  throwOnError: ThrowOnError<TQueryFnData, TError, TQueryData, TQueryKey>\n  query: Query<TQueryFnData, TError, TQueryData, TQueryKey> | undefined\n  suspense: boolean | undefined\n}) => {\n  return (\n    result.isError &&\n    !errorResetBoundary.isReset() &&\n    !result.isFetching &&\n    query &&\n    ((suspense && result.data === undefined) ||\n      shouldThrowError(throwOnError, [result.error, query]))\n  )\n}\n","'use client'\nimport { QueryObserver } from '@tanstack/query-core'\nimport { useBaseQuery } from './useBaseQuery'\nimport type {\n  DefaultError,\n  NoInfer,\n  QueryClient,\n  QueryKey,\n} from '@tanstack/query-core'\nimport type {\n  DefinedUseQueryResult,\n  UseQueryOptions,\n  UseQueryResult,\n} from './types'\nimport type {\n  DefinedInitialDataOptions,\n  UndefinedInitialDataOptions,\n} from './queryOptions'\n\nexport function useQuery<\n  TQueryFnData = unknown,\n  TError = DefaultError,\n  TData = TQueryFnData,\n  TQueryKey extends QueryKey = QueryKey,\n>(\n  options: DefinedInitialDataOptions<TQueryFnData, TError, TData, TQueryKey>,\n  queryClient?: QueryClient,\n): DefinedUseQueryResult<NoInfer<TData>, TError>\n\nexport function useQuery<\n  TQueryFnData = unknown,\n  TError = DefaultError,\n  TData = TQueryFnData,\n  TQueryKey extends QueryKey = QueryKey,\n>(\n  options: UndefinedInitialDataOptions<TQueryFnData, TError, TData, TQueryKey>,\n  queryClient?: QueryClient,\n): UseQueryResult<NoInfer<TData>, TError>\n\nexport function useQuery<\n  TQueryFnData = unknown,\n  TError = DefaultError,\n  TData = TQueryFnData,\n  TQueryKey extends QueryKey = QueryKey,\n>(\n  options: UseQueryOptions<TQueryFnData, TError, TData, TQueryKey>,\n  queryClient?: QueryClient,\n): UseQueryResult<NoInfer<TData>, TError>\n\nexport function useQuery(options: UseQueryOptions, queryClient?: QueryClient) {\n  return useBaseQuery(options, QueryObserver, queryClient)\n}\n","import { useQuery, useQueryClient } from '@tanstack/react-query';\r\nimport API from '../api';\r\n\r\nfunction decodeJwt() {\r\n  try {\r\n    const t = localStorage.getItem('token');\r\n    if (!t) return null;\r\n    const [, payload] = t.split('.');\r\n    return JSON.parse(atob(payload.replace(/-/g,'+').replace(/_/g,'/')));\r\n  } catch { return null; }\r\n}\r\n\r\nexport function useAuth() {\r\n  const qc = useQueryClient();\r\n  const token = typeof window !== 'undefined' ? localStorage.getItem('token') : null;\r\n  const { data: me, isLoading, error } = useQuery({\r\n    queryKey: ['me', token],\r\n    queryFn: async () => {\r\n      if (!token) return null;\r\n      const { data } = await API.get('/user/me');\r\n      return data;\r\n    },\r\n    enabled: !!token,\r\n  });\r\n  const jwt = decodeJwt();\r\n  const role = jwt?.role || localStorage.getItem('role') || me?.role;\r\n  return { user: me, role, token, isLoading, error, refetch: () => qc.invalidateQueries({ queryKey: ['me'] }) };\r\n}\r\n","// Calendar utility extracted from Events.js to allow reuse & testing\r\n// Provides: getMonday, addDays, sameDay, ymd, parseTimeFlexible, computeLayout (overlap aware), eventDateRange, eachDay\r\n\r\nimport { timeToMin } from '../settings';\r\n\r\nexport const DAYS_7 = ['Lundi','Mardi','Mercredi','Jeudi','Vendredi','Samedi','Dimanche'];\r\n\r\nexport function getMonday(date = new Date()) {\r\n  const d = new Date(date); d.setHours(0,0,0,0);\r\n  const day = d.getDay();\r\n  const diff = (day === 0 ? -6 : 1 - day);\r\n  d.setDate(d.getDate() + diff);\r\n  return d;\r\n}\r\nexport function addDays(date, n) { const d = new Date(date); d.setDate(d.getDate() + n); d.setHours(0,0,0,0); return d; }\r\nexport function sameDay(a,b){ return a.getFullYear()===b.getFullYear() && a.getMonth()===b.getMonth() && a.getDate()===b.getDate(); }\r\nexport function ymd(d){ const y=d.getFullYear(); const m=String(d.getMonth()+1).padStart(2,'0'); const dd=String(d.getDate()).padStart(2,'0'); return `${y}-${m}-${dd}`; }\r\n\r\nexport function parseTimeFlexible(t){\r\n  if(!t) return 0;\r\n  if (typeof t === 'string' && t.includes(':')) return timeToMin(t) ?? 0;\r\n  if (t instanceof Date) return t.getHours()*60 + t.getMinutes();\r\n  const n = Number(t); if(!Number.isNaN(n)) return n;\r\n  return 0;\r\n}\r\n\r\n// Color helpers\r\nconst palette = [\r\n  { bg: '#DBEAFE', border: '#93C5FD' },\r\n  { bg: '#FDE68A', border: '#F59E0B' },\r\n  { bg: '#FBCFE8', border: '#F472B6' },\r\n  { bg: '#BFDBFE', border: '#60A5FA' },\r\n  { bg: '#C7F9CC', border: '#34D399' },\r\n  { bg: '#FECACA', border: '#F87171' },\r\n  { bg: '#E9D5FF', border: '#C084FC' },\r\n];\r\nexport function colorForKey(key=''){\r\n  let h=0; for(let i=0;i<key.length;i++) h=(h*31 + key.charCodeAt(i))>>>0;\r\n  return palette[h % palette.length];\r\n}\r\nfunction hexToRgb(hex){ if(!hex) return null; const c=hex.replace('#',''); const full=c.length===3?c.split('').map(ch=>ch+ch).join(''):c; const r=parseInt(full.slice(0,2),16); const g=parseInt(full.slice(2,4),16); const b=parseInt(full.slice(4,6),16); if([r,g,b].some(v=>Number.isNaN(v))) return null; return {r,g,b}; }\r\nfunction yiq(r,g,b){ return (r*299 + g*587 + b*114)/1000; }\r\nexport function textColorsForBg(bgHex){ const rgb=hexToRgb(bgHex); if(!rgb) return { text:'#111', muted:'rgba(17,17,17,0.7)', shadow:'none'}; const y=yiq(rgb.r,rgb.g,rgb.b); if(y>=186) return { text:'#111', muted:'rgba(17,17,17,0.6)', shadow:'0 1px 0 rgba(255,255,255,0.5)'}; return { text:'#fff', muted:'rgba(255,255,255,0.75)', shadow:'0 1px 0 rgba(0,0,0,0.4)'}; }\r\n\r\n// Determine day name inside displayed week\r\nfunction dayNameOf(item, monday){\r\n  if (item.day && DAYS_7.includes(item.day)) return item.day;\r\n  const d = item.date ? new Date(item.date) : (item.startDate ? new Date(item.startDate) : null);\r\n  if(!d) return null; d.setHours(0,0,0,0);\r\n  for(let i=0;i<7;i++){ const wd=addDays(monday,i); if(sameDay(d,wd)) return DAYS_7[i]; }\r\n  return null;\r\n}\r\n\r\nexport function computeLayout(items, startMin, endMin, pxPerMin, monday){\r\n  const byDay = DAYS_7.reduce((acc,d)=>({...acc,[d]:[]}),{});\r\n  items.forEach(it=>{ const dname=dayNameOf(it, monday||getMonday()); if(dname) byDay[dname].push(it); });\r\n  const result={};\r\n  DAYS_7.forEach(day=>{\r\n    const arr = byDay[day]\r\n      .map(it=>{\r\n        const sMin = it.startHour ? parseTimeFlexible(it.startHour) : (it.start ? parseTimeFlexible(it.start) : startMin);\r\n        const eMin = it.endHour ? parseTimeFlexible(it.endHour) : (it.end ? parseTimeFlexible(it.end) : endMin);\r\n        const start = Math.max(sMin, startMin);\r\n        const end = Math.min(eMin, endMin);\r\n        return { ...it, start, end };\r\n      })\r\n      .filter(it=>it.end>it.start)\r\n      .sort((a,b)=>(a.start-b.start)||(a.end-b.end));\r\n\r\n    let active=[]; let clusterId=-1; const usedCols=new Set(); const clusters=new Map(); const out=[];\r\n    const releaseEnded = (currentStart)=>{\r\n      active = active.filter(x=>{ if(x.end<=currentStart){ usedCols.delete(x._col); return false;} return true; });\r\n      if(active.length===0){ usedCols.clear(); clusterId+=1; }\r\n    };\r\n    arr.forEach(it=>{\r\n      releaseEnded(it.start);\r\n      let col=0; while(usedCols.has(col)) col+=1;\r\n      usedCols.add(col); active.push({ ...it, _col: col });\r\n      const maxCols=Math.max(col+1, clusters.get(clusterId)||0); clusters.set(clusterId, maxCols);\r\n      const pal=colorForKey(it.title||it.subject||''); const bg=it.color||pal.bg; const border=it.borderColor||pal.border; const {text,muted,shadow}=textColorsForBg(bg);\r\n      out.push({ ...it, clusterId, col, top:(it.start-startMin)*pxPerMin, height:(it.end-it.start)*pxPerMin, style:{ backgroundColor:bg, borderColor:border, textColor:text, mutedColor:muted, textShadow:shadow }});\r\n    });\r\n    const maxColsByCluster=Object.fromEntries(clusters.entries());\r\n    out.forEach(s=>{ const cols=maxColsByCluster[s.clusterId]||1; s.width=100/cols; s.left=(s.col*100)/cols; });\r\n    result[day]=out;\r\n  });\r\n  return result;\r\n}\r\n\r\n// Month helpers\r\nexport function startOfMonth(d){ return new Date(d.getFullYear(), d.getMonth(), 1); }\r\nexport function mondayBefore(d){ const x=new Date(d); x.setHours(0,0,0,0); const day=x.getDay(); const diff=(day===0?-6:1-day); x.setDate(x.getDate()+diff); return x; }\r\nexport function addMonths(d,n){ const x=new Date(d); x.setMonth(x.getMonth()+n); x.setDate(1); x.setHours(0,0,0,0); return x; }\r\nfunction parseDateLike(v){ if(!v) return null; const d=v instanceof Date? new Date(v.getTime()): new Date(v); if(Number.isNaN(d.getTime())) return null; d.setHours(0,0,0,0); return d; }\r\nexport function eventDateRange(ev){ const s=parseDateLike(ev.date||ev.startDate||ev.start); const e=parseDateLike(ev.endDate||ev.end)||s; if(!s) return null; return { start:s, end:e }; }\r\nexport function eachDay(start,end){ const days=[]; const d=new Date(start); while(d<=end){ days.push(new Date(d)); d.setDate(d.getDate()+1);} return days; }\r\n","import React, { useEffect, useMemo, useRef, useState } from 'react';\r\nimport API from '../api';\r\nimport { useQuery } from '@tanstack/react-query';\r\nimport './Events.css';\r\nimport { useSettings, cssVars, timeToMin } from '../settings';\r\nimport { useAuth } from '../hooks/useAuth';\r\nimport MediaUpload from './MediaUpload';\r\nimport {\r\n  DAYS_7,\r\n  getMonday,\r\n  addDays,\r\n  sameDay,\r\n  ymd,\r\n  computeLayout,\r\n  startOfMonth,\r\n  mondayBefore,\r\n  addMonths,\r\n  eventDateRange,\r\n  eachDay,\r\n} from '../utils/calendar';\r\n\r\nconst START_MIN_FALLBACK = 8 * 60;\r\nconst END_MIN_FALLBACK = 19 * 60;\r\n\r\nfunction absUrl(u) {\r\n  if (!u) return '';\r\n  if (/^https?:\\/\\//i.test(u)) return u;\r\n  if (u.startsWith('/')) return (API?.defaults?.baseURL || '').replace(/\\/$/, '') + u;\r\n  return u;\r\n}\r\n\r\nfunction formatRange(monday) {\r\n  const end = addDays(monday, 6);\r\n  const fmt = (d) => d.toLocaleDateString('fr-FR', { day: '2-digit', month: 'short' });\r\n  return `${fmt(monday)} – ${fmt(end)}`;\r\n}\r\n\r\nfunction Events() {\r\n  const { settings } = useSettings();\r\n  const { user, token, refetch: refetchMe } = useAuth();\r\n  const [view, setView] = useState('week'); // 'week' | 'month'\r\n  const [monday, setMonday] = useState(() => getMonday());\r\n  const [monthRef, setMonthRef] = useState(() => startOfMonth(new Date()));\r\n  const [items, setItems] = useState([]); // local copy for layout (can remove later)\r\n  const [err, setErr] = useState('');\r\n  const [page, setPage] = useState(1);\r\n  const limit = 200; // future: user setting\r\n  const isAdmin = localStorage.getItem('role') === 'admin';\r\n\r\n  // Formulaire création (admin)\r\n  const [clubs, setClubs] = useState([]);\r\n  const [form, setForm] = useState({\r\n    title: '',\r\n    date: ymd(new Date()),\r\n    endDate: '',\r\n    startHour: '',\r\n    endHour: '',\r\n    location: '',\r\n  color: '#93C5FD',\r\n  imageUrl: '',\r\n    description: '',\r\n    clubId: '', // optionnel\r\n  });\r\n\r\n  const startMin = timeToMin(settings?.schedule?.timeStart) ?? START_MIN_FALLBACK;\r\n  const endMin   = timeToMin(settings?.schedule?.timeEnd)   ?? END_MIN_FALLBACK;\r\n  const basePxPerMin = settings?.ui?.pxPerMin ?? 1.2;\r\n  const [zoom, setZoom] = useState(1);\r\n  const eventsScrollRef = useRef(null);\r\n  const isPanningRef = useRef(false);\r\n  const panStartRef = useRef({ x: 0, y: 0, left: 0, top: 0 });\r\n  const clamp = (v, min, max) => Math.max(min, Math.min(max, v));\r\n  const pxPerMin = basePxPerMin * zoom;\r\n\r\n  // Date range (week view base) for future server filtering\r\n  const from = view === 'week' ? ymd(monday) : undefined;\r\n  const to = view === 'week' ? ymd(addDays(monday,6)) : undefined;\r\n  const [clubFilter, setClubFilter] = useState('');\r\n\r\n  // Local follow state (pinned + subscribed) for immediate UI feedback\r\n  const [pinnedEvents, setPinnedEvents] = useState([]);\r\n  const [subscribedEvents, setSubscribedEvents] = useState([]);\r\n\r\n  // Sync local sets when /me changes\r\n  useEffect(() => {\r\n    if (user) {\r\n      setPinnedEvents(user.pinnedEvents || []);\r\n      setSubscribedEvents(user.subscribedEvents || []);\r\n    } else {\r\n      setPinnedEvents([]);\r\n      setSubscribedEvents([]);\r\n    }\r\n  }, [user]);\r\n\r\n  const { data: eventsResp, isLoading: loadingEvents } = useQuery({\r\n    queryKey: ['events', { page, limit, from, to, club: clubFilter }],\r\n    queryFn: async () => {\r\n      const params = new URLSearchParams();\r\n      params.set('page', page);\r\n      params.set('limit', limit);\r\n      if (from) params.set('from', from);\r\n      if (to) params.set('to', to);\r\n      if (clubFilter) params.set('clubId', clubFilter);\r\n      const { data } = await API.get('/events?' + params.toString());\r\n      // new service returns { events, total, page, pages }\r\n      if (Array.isArray(data)) return { events: data, total: data.length, page:1, pages:1 }; // backward guard\r\n      return data;\r\n    },\r\n    staleTime: 120_000,\r\n  });\r\n\r\n  useEffect(() => {\r\n    if (eventsResp?.events) setItems(eventsResp.events);\r\n  }, [eventsResp]);\r\n\r\n  // Fetch clubs (pour lier un event à un club) si admin\r\n  const fetchClubs = React.useCallback(async () => {\r\n    if (!isAdmin) return;\r\n    try {\r\n      const { data } = await API.get('/clubs');\r\n      setClubs(Array.isArray(data) ? data : []);\r\n    } catch {\r\n      // silencieux\r\n    }\r\n  }, [isAdmin]);\r\n\r\n  // initial sync done by react-query\r\n  useEffect(() => { fetchClubs(); }, [fetchClubs]);\r\n\r\n  const layout = useMemo(\r\n    () => computeLayout(items, startMin, endMin, pxPerMin, monday),\r\n    [items, startMin, endMin, pxPerMin, monday]\r\n  );\r\n\r\n  const weekDays = useMemo(() => Array.from({ length: 7 }, (_, i) => addDays(monday, i)), [monday]);\r\n\r\n  const now = new Date();\r\n  const nowMin = now.getHours() * 60 + now.getMinutes();\r\n  const showNow = (settings?.schedule?.showNowLine ?? true) && nowMin >= startMin && nowMin <= endMin;\r\n\r\n  // Mois\r\n  const monthStart = useMemo(() => startOfMonth(monthRef), [monthRef]);\r\n  const gridStart = useMemo(() => mondayBefore(monthStart), [monthStart]);\r\n  const monthDays = useMemo(() => Array.from({ length: 42 }, (_, i) => {\r\n    const d = new Date(gridStart); d.setDate(d.getDate() + i); return d;\r\n  }), [gridStart]);\r\n\r\n  const eventsByDay = useMemo(() => {\r\n    const map = new Map();\r\n    for (const ev of items) {\r\n      const range = eventDateRange(ev);\r\n      if (!range) continue;\r\n      for (const d of eachDay(range.start, range.end)) {\r\n        const k = ymd(d);\r\n        if (!map.has(k)) map.set(k, []);\r\n        map.get(k).push(ev);\r\n      }\r\n    }\r\n    for (const [, arr] of map) {\r\n      arr.sort((a,b) => {\r\n        const sa = a.startHour ? timeToMin(a.startHour) : 0;\r\n        const sb = b.startHour ? timeToMin(b.startHour) : 0;\r\n        return sa - sb;\r\n      });\r\n    }\r\n    return map;\r\n  }, [items]);\r\n\r\n  // Navigation\r\n  const prev = () => {\r\n    if (view === 'week') setMonday(addDays(monday, -7));\r\n    else setMonthRef(addMonths(monthRef, -1));\r\n  };\r\n  const next = () => {\r\n    if (view === 'week') setMonday(addDays(monday, 7));\r\n    else setMonthRef(addMonths(monthRef, 1));\r\n  };\r\n\r\n  // Zoom & pan (week view only)\r\n  const onWheel = (e) => {\r\n    if (view !== 'week') return; // allow normal scroll in month view\r\n    e.preventDefault();\r\n    const container = eventsScrollRef.current; if (!container) return;\r\n    const rect = container.getBoundingClientRect();\r\n    const pointerY = e.clientY - rect.top + container.scrollTop;\r\n    const old = zoom;\r\n    const nextZ = clamp(old * (e.deltaY < 0 ? 1.1 : 0.9), 0.6, 3);\r\n    if (nextZ === old) return;\r\n    const scale = nextZ / old;\r\n    const newScrollTop = pointerY * scale - (e.clientY - rect.top);\r\n    setZoom(nextZ);\r\n    requestAnimationFrame(() => { container.scrollTop = newScrollTop; });\r\n  };\r\n  const onMouseDown = (e) => {\r\n    if (view !== 'week') return;\r\n    const c = eventsScrollRef.current; if (!c) return;\r\n    isPanningRef.current = true;\r\n    panStartRef.current = { x: e.clientX, y: e.clientY, left: c.scrollLeft, top: c.scrollTop };\r\n    c.style.cursor = 'grabbing';\r\n    window.addEventListener('mousemove', onMouseMove);\r\n    window.addEventListener('mouseup', onMouseUp);\r\n  };\r\n  const onMouseMove = (e) => {\r\n    if (!isPanningRef.current) return;\r\n    const c = eventsScrollRef.current; if (!c) return;\r\n    const dx = e.clientX - panStartRef.current.x;\r\n    const dy = e.clientY - panStartRef.current.y;\r\n    c.scrollLeft = panStartRef.current.left - dx;\r\n    c.scrollTop = panStartRef.current.top - dy;\r\n  };\r\n  const onMouseUp = () => {\r\n    isPanningRef.current = false;\r\n    const c = eventsScrollRef.current; if (c) c.style.cursor = 'grab';\r\n    window.removeEventListener('mousemove', onMouseMove);\r\n    window.removeEventListener('mouseup', onMouseUp);\r\n  };\r\n\r\n  // Handlers form\r\n  const onChange = (e) => setForm((f) => ({ ...f, [e.target.name]: e.target.value }));\r\n  const createEvent = async (e) => {\r\n    e.preventDefault();\r\n    setErr('');\r\n    try {\r\n      if (!form.title || !form.date) return setErr('Titre et date requis');\r\n      if (form.startHour && form.endHour && !(form.startHour < form.endHour)) {\r\n        return setErr(\"L'heure de début doit être avant l'heure de fin\");\r\n      }\r\n      const payload = {\r\n        title: form.title.trim(),\r\n        date: form.date,\r\n        endDate: form.endDate || undefined,\r\n        startHour: form.startHour || undefined,\r\n        endHour: form.endHour || undefined,\r\n        location: form.location || undefined,\r\n        description: form.description || undefined,\r\n        // Si imageUrl est fourni, on l’envoie et on laisse la couleur en fallback\r\n        imageUrl: form.imageUrl || undefined,\r\n        color: form.imageUrl ? undefined : (form.color || undefined),\r\n        clubId: form.clubId || undefined,\r\n      };\r\n      const { data } = await API.post('/events', payload);\r\n      // reset + refresh\r\n  setForm((f) => ({ ...f, title: '', startHour: '', endHour: '', location: '', description: '', color: '#93C5FD', imageUrl: '' }));\r\n      setItems((list) => [data, ...list]);\r\n    } catch (e2) {\r\n      setErr(e2.response?.data?.error || 'Erreur création événement (réservé admin)');\r\n    }\r\n  };\r\n\r\n  const deleteEvent = async (id) => {\r\n    if (!isAdmin) return;\r\n    try {\r\n      await API.delete(`/events/${id}`);\r\n      setItems((list) => list.filter((x) => x._id !== id));\r\n    } catch (e2) {\r\n      setErr(e2.response?.data?.error || 'Erreur suppression');\r\n    }\r\n  };\r\n\r\n  // Unified follow: subscribe + pin; unfollow: unsubscribe + unpin\r\n  const isFollowed = (id) => pinnedEvents.includes(id) && subscribedEvents.includes(id);\r\n  const toggleFollow = async (id) => {\r\n    if (!token) return; // require auth\r\n    const followed = isFollowed(id);\r\n    try {\r\n      if (!followed) {\r\n        // Optimistic\r\n        setPinnedEvents((s) => s.includes(id) ? s : s.concat(id));\r\n        setSubscribedEvents((s) => s.includes(id) ? s : s.concat(id));\r\n        await Promise.all([\r\n          API.post(`/events/${id}/pin`),\r\n          API.post(`/events/${id}/subscribe`),\r\n        ]);\r\n      } else {\r\n        setPinnedEvents((s) => s.filter((x) => x !== id));\r\n        setSubscribedEvents((s) => s.filter((x) => x !== id));\r\n        await Promise.all([\r\n          API.post(`/events/${id}/unpin`),\r\n          API.post(`/events/${id}/unsubscribe`),\r\n        ]);\r\n      }\r\n    } catch {\r\n      // rollback simple (refetch server truth)\r\n      refetchMe();\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"events-wrap\" style={{ ...cssVars(settings) }}>\r\n      <div className=\"events-head\" style={{ display: 'flex', alignItems: 'center', gap: 8, justifyContent: 'space-between', marginBottom: 8 }}>\r\n        <div style={{ display: 'flex', alignItems: 'center', gap: 8 }}>\r\n          <h2 style={{ margin: 0 }}>Mes événements</h2>\r\n          {view === 'week' ? (\r\n            <div style={{ color: 'var(--muted)' }}>{formatRange(monday)}</div>\r\n          ) : (\r\n            <div style={{ color: 'var(--muted)' }}>\r\n              {monthStart.toLocaleDateString('fr-FR', { month: 'long', year: 'numeric' })}\r\n            </div>\r\n          )}\r\n        </div>\r\n        <div style={{ display: 'flex', gap: 8, alignItems: 'center' }}>\r\n          <div className=\"view-switch\" role=\"tablist\" aria-label=\"Vue calendrier\">\r\n            <button className=\"week-btn\" onClick={() => setView('week')} aria-pressed={view==='week'}>Semaine</button>\r\n            <button className=\"week-btn\" onClick={() => setView('month')} aria-pressed={view==='month'}>Mois</button>\r\n          </div>\r\n          <button className=\"week-btn\" onClick={prev}>⟵ Précédent</button>\r\n          <button className=\"week-btn\" onClick={next}>Suivant ⟶</button>\r\n        </div>\r\n      </div>\r\n\r\n      {err && <div style={{ color: 'crimson', marginBottom: 12 }}>{err}</div>}\r\n      {loadingEvents && <div style={{ color: 'var(--muted)', marginBottom: 12 }}>Chargement…</div>}\r\n      <div style={{ display:'flex', gap:8, flexWrap:'wrap', marginBottom:12 }}>\r\n        <select value={clubFilter} onChange={e=>{ setPage(1); setClubFilter(e.target.value); }} className=\"week-btn\" style={{ padding:4 }}>\r\n          <option value=\"\">Tous les clubs</option>\r\n          {clubs.map(c=> <option key={c._id} value={c._id}>{c.clubName}</option>)}\r\n        </select>\r\n      </div>\r\n      {!loadingEvents && eventsResp && eventsResp.pages > 1 && (\r\n        <div style={{ display:'flex', gap:8, marginBottom:12 }}>\r\n          <button className=\"week-btn\" disabled={page<=1} onClick={()=>setPage(p=>p-1)}>Page -</button>\r\n          <div>Page {eventsResp.page} / {eventsResp.pages}</div>\r\n          <button className=\"week-btn\" disabled={page>=eventsResp.pages} onClick={()=>setPage(p=>p+1)}>Page +</button>\r\n        </div>\r\n      )}\r\n\r\n      {isAdmin && (\r\n        <form onSubmit={createEvent} style={{ display: 'grid', gridTemplateColumns: 'repeat(8, minmax(140px, 1fr))', gap: 8, marginBottom: 12 }}>\r\n          <label>\r\n            Titre\r\n            <input name=\"title\" value={form.title} onChange={onChange} required />\r\n          </label>\r\n          <label>\r\n            Date\r\n            <input name=\"date\" type=\"date\" value={form.date} onChange={onChange} required />\r\n          </label>\r\n          <label>\r\n            Fin (facultatif)\r\n            <input name=\"endDate\" type=\"date\" value={form.endDate} onChange={onChange} />\r\n          </label>\r\n          <label>\r\n            Début\r\n            <input name=\"startHour\" type=\"time\" value={form.startHour} onChange={onChange} />\r\n          </label>\r\n          <label>\r\n            Fin\r\n            <input name=\"endHour\" type=\"time\" value={form.endHour} onChange={onChange} />\r\n          </label>\r\n          <label>\r\n            Lieu\r\n            <input name=\"location\" value={form.location} onChange={onChange} />\r\n          </label>\r\n          <div style={{ display:'flex', flexDirection:'column', gap:6 }}>\r\n            <label>Image (remplace la couleur si définie)</label>\r\n            <MediaUpload onUploaded={(d)=> setForm(f=>({ ...f, imageUrl: d.status==='approved' ? (d.absoluteUrl || absUrl(d.url)) : '' }))} />\r\n            <div style={{ display:'flex', alignItems:'center', gap:8 }}>\r\n              <small style={{ color:'var(--muted)' }}>ou couleur</small>\r\n              <input name=\"color\" type=\"color\" value={form.color} onChange={onChange} />\r\n            </div>\r\n            {form.imageUrl && (\r\n              <div style={{ display:'flex', alignItems:'center', gap:8 }}>\r\n                <img loading=\"lazy\" src={form.imageUrl} alt=\"aperçu\" style={{ height:32, borderRadius:4, border:'1px solid var(--line)' }} />\r\n                <button type=\"button\" className=\"week-btn\" onClick={()=> setForm(f=>({ ...f, imageUrl:'' }))}>Retirer l’image</button>\r\n              </div>\r\n            )}\r\n          </div>\r\n          <label>\r\n            Club (optionnel)\r\n            <select name=\"clubId\" value={form.clubId} onChange={onChange}>\r\n              <option value=\"\">— Aucun —</option>\r\n              {clubs.map((c) => (\r\n                <option key={c._id} value={c._id}>{c.clubName}</option>\r\n              ))}\r\n            </select>\r\n          </label>\r\n          <label style={{ gridColumn: '1 / -1' }}>\r\n            Description\r\n            <input name=\"description\" value={form.description} onChange={onChange} />\r\n          </label>\r\n          <div style={{ gridColumn: '1 / -1' }}>\r\n            <button type=\"submit\" className=\"week-btn\">Créer l’événement (admin)</button>\r\n          </div>\r\n        </form>\r\n      )}\r\n\r\n      {view === 'week' ? (\r\n        <div\r\n          className=\"events-grid-scroll\"\r\n          ref={eventsScrollRef}\r\n          onWheel={onWheel}\r\n          onMouseDown={onMouseDown}\r\n          style={{ cursor: 'grab', '--px-per-min': pxPerMin }}\r\n        >\r\n          <div className=\"events-grid\">\r\n            <div className=\"events-hours-col\" aria-hidden=\"true\">\r\n              {Array.from({ length: endMin - startMin }, (_, i) => i)\r\n                .filter((m) => m % 60 === 0)\r\n                .map((m) => {\r\n                  const h = Math.floor((startMin + m) / 60);\r\n                  const mm = String((startMin + m) % 60).padStart(2, '0');\r\n                  return (\r\n                    <div className=\"events-hour-label\" key={m}>\r\n                      {String(h).padStart(2, '0')}:{mm}\r\n                    </div>\r\n                  );\r\n                })}\r\n            </div>\r\n\r\n            {DAYS_7.map((d, idx) => {\r\n              const dayDate = weekDays[idx];\r\n              return (\r\n                <div className=\"events-day-col\" key={d}>\r\n                  <div className=\"events-day-header\">{d}</div>\r\n                  <div className=\"events-day-content\">\r\n                    {showNow && sameDay(dayDate, now) && (\r\n                      <div className=\"events-now-line\" style={{ top: (nowMin - startMin) * pxPerMin }} />\r\n                    )}\r\n\r\n        {layout[d]?.map((slot, i) => (\r\n                      <div\r\n                        key={(slot._id || slot.id || i) + '-' + d}\r\n                        className=\"events-slot\"\r\n                        style={{\r\n          '--slot-top': `${slot.top}px`,\r\n          '--slot-height': `${slot.height}px`,\r\n          '--slot-left': `calc(${slot.left}% + var(--col-pad))`,\r\n          '--slot-width': `calc(${slot.width}% - (var(--col-pad) * 2))`,\r\n          backgroundColor: slot.imageUrl ? 'transparent' : slot.style.backgroundColor,\r\n          borderColor: slot.style.borderColor,\r\n          color: slot.style.textColor,\r\n          textShadow: slot.style.textShadow,\r\n                          backgroundImage: slot.imageUrl ? `linear-gradient(0deg, rgba(0,0,0,0.35), rgba(0,0,0,0.35)), url(${absUrl(slot.imageUrl)})` : undefined,\r\n          backgroundSize: slot.imageUrl ? 'cover' : undefined,\r\n          backgroundPosition: slot.imageUrl ? 'center' : undefined,\r\n                        }}\r\n                      >\r\n                        <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', gap: 8 }}>\r\n                          <div className=\"events-slot-title\">{slot.title || slot.subject || 'Événement'}</div>\r\n                          <div style={{ display:'flex', alignItems:'center', gap:4 }}>\r\n                            {token && (\r\n                              <button\r\n                                onClick={() => toggleFollow(slot._id)}\r\n                                className=\"week-btn\"\r\n                                style={{ padding: '2px 6px', fontSize: 12 }}\r\n                                title={isFollowed(slot._id) ? 'Ne plus suivre (retire de mon EDT & notifications)' : 'Suivre (ajoute à mon EDT & notifications)'}\r\n                              >\r\n                                {isFollowed(slot._id) ? 'Suivi ✓' : 'Suivre'}\r\n                              </button>\r\n                            )}\r\n                            {isAdmin && (\r\n                              <button\r\n                                onClick={() => deleteEvent(slot._id)}\r\n                                style={{ background: 'transparent', border: 'none', color: slot.style.mutedColor, cursor: 'pointer' }}\r\n                                title=\"Supprimer (admin)\"\r\n                              >\r\n                                🗑️\r\n                              </button>\r\n                            )}\r\n                          </div>\r\n                        </div>\r\n                        <div className=\"events-slot-time\" style={{ color: slot.style.mutedColor }}>\r\n                          {(slot.startHour || '').toString()}{slot.endHour ? ` – ${slot.endHour}` : ''}\r\n                        </div>\r\n                        {slot.location && (\r\n                          <div className=\"events-slot-loc\" style={{ color: slot.style.mutedColor }}>\r\n                            @ {slot.location}\r\n                          </div>\r\n                        )}\r\n                      </div>\r\n                    ))}\r\n                  </div>\r\n                </div>\r\n              );\r\n            })}\r\n          </div>\r\n        </div>\r\n      ) : (\r\n        // Vue Mois\r\n        <div className=\"events-month-scroll\">\r\n          <div className=\"events-month-grid\">\r\n            <div className=\"events-month-weekdays\">\r\n              {['Lun','Mar','Mer','Jeu','Ven','Sam','Dim'].map((wd) => (\r\n                <div key={wd} className=\"events-month-weekday\">{wd}</div>\r\n              ))}\r\n            </div>\r\n            {monthDays.map((d) => {\r\n              const key = ymd(d);\r\n              const isOther = d.getMonth() !== monthStart.getMonth();\r\n              const isToday = ymd(d) === ymd(new Date());\r\n              const list = eventsByDay.get(key) || [];\r\n              const maxVisible = 5;\r\n              const visible = list.slice(0, maxVisible);\r\n              const more = list.length - visible.length;\r\n\r\n              return (\r\n                <div key={key} className={`events-month-cell${isOther ? ' is-other-month' : ''}${isToday ? ' is-today' : ''}`}>\r\n                  <div className=\"events-month-cell-head\">\r\n                    <span className=\"events-month-daynum\">{d.getDate()}</span>\r\n                  </div>\r\n                  <div className=\"events-month-items\">\r\n                    {visible.map((ev, i) => {\r\n                      const color = ev.color || (ev.style?.backgroundColor) || '#93C5FD';\r\n                      return (\r\n                        <div key={(ev._id||ev.id||i)+'-'+key} className=\"events-month-item\" title={ev.title || ev.subject || ''} style={{ display:'flex', alignItems:'center', gap:4 }}>\r\n                          {ev.imageUrl ? (\r\n                            <span style={{ width: 16, height: 16, borderRadius: 3, backgroundImage: `url(${absUrl(ev.imageUrl)})`, backgroundSize:'cover', backgroundPosition:'center', flex:'0 0 16px' }} />\r\n                          ) : (\r\n                            <span className=\"events-month-dot\" style={{ backgroundColor: color }} />\r\n                          )}\r\n                          <span style={{ flex:1, overflow: 'hidden', textOverflow: 'ellipsis' }}>\r\n                            {ev.title || ev.subject || 'Événement'}{ev.startHour && ev.endHour ? ` • ${ev.startHour}–${ev.endHour}` : ''}\r\n                          </span>\r\n                          {token && (\r\n                            <button\r\n                              onClick={() => toggleFollow(ev._id)}\r\n                              style={{ background:'transparent', border:'none', cursor:'pointer', color: isFollowed(ev._id)? color : 'var(--muted)', fontSize: 14, lineHeight:1 }}\r\n                              title={isFollowed(ev._id) ? 'Ne plus suivre' : 'Suivre'}\r\n                            >\r\n                              {isFollowed(ev._id) ? '★' : '☆'}\r\n                            </button>\r\n                          )}\r\n                        </div>\r\n                      );\r\n                    })}\r\n                    {more > 0 && <div className=\"events-month-more\">+{more} autres…</div>}\r\n                  </div>\r\n                </div>\r\n              );\r\n            })}\r\n          </div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Events;\r\n","import React, { useRef, useState } from 'react';\r\nimport API from '../api';\r\n\r\nexport default function MediaUpload({ onUploaded, showPreview = true, previewSize = 64 }) {\r\n  const [file, setFile] = useState(null);\r\n  const [status, setStatus] = useState('');\r\n  const [preview, setPreview] = useState('');\r\n  const inputRef = useRef(null);\r\n\r\n  const submit = async (e) => {\r\n    e?.preventDefault?.();\r\n    if (!file) return;\r\n    setStatus('Envoi...');\r\n    const fd = new FormData();\r\n    fd.append('file', file);\r\n    try {\r\n  const { data } = await API.post('/media/image', fd, { headers: { 'Content-Type': 'multipart/form-data' } });\r\n  setStatus(data.status === 'approved' ? 'OK' : 'En attente modération');\r\n  // Clear the initial local file and its preview\r\n  setFile(null);\r\n  if (inputRef.current) inputRef.current.value = '';\r\n  // After upload: show a small server-side preview only if approved (has public url)\r\n  const base = API?.defaults?.baseURL?.replace(/\\/$/, '') || '';\r\n  const absoluteUrl = data?.url ? (data.url.startsWith('/') ? (base + data.url) : data.url) : '';\r\n  setPreview(data.status === 'approved' && absoluteUrl ? absoluteUrl : '');\r\n  if (onUploaded) onUploaded({ ...data, absoluteUrl });\r\n    } catch (e2) {\r\n      const msg = e2.response?.data?.error || 'Erreur upload';\r\n      setStatus(msg);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div style={{ display: 'flex', flexDirection: 'column', gap: 8 }}>\r\n      <input\r\n        type=\"file\"\r\n        accept=\"image/png,image/jpeg,image/webp\"\r\n        ref={inputRef}\r\n        onChange={(e) => {\r\n          const f = e.target.files?.[0];\r\n          if (!f) return;\r\n          if (f.size > 2 * 1024 * 1024) { // client hint; server enforces too\r\n            setStatus('> 2MB refusé'); return;\r\n          }\r\n          setFile(f);\r\n          setPreview(URL.createObjectURL(f));\r\n          setStatus('');\r\n        }}\r\n      />\r\n      {showPreview && preview && (\r\n        <img\r\n          src={preview}\r\n          alt=\"prévisualisation\"\r\n          style={{ width: previewSize, height: previewSize, objectFit: 'cover', border: '1px solid var(--line)', borderRadius: 6 }}\r\n        />\r\n      )}\r\n      <button className=\"week-btn\" type=\"button\" onClick={submit} disabled={!file}>Uploader l’image</button>\r\n      {status && <small style={{ color: 'var(--muted)' }}>{status}</small>}\r\n    </div>\r\n  );\r\n}\r\n"],"names":["defaultSettings","theme","mode","ui","pxPerMin","dayMinW","hoursColW","colGap","colPad","slotHoverMinH","monthCellH","monthCellPad","schedule","days","timeStart","timeEnd","showNowLine","events","ab","SettingsContext","createContext","settings","updateSettings","useSettings","useContext","timeToMin","t","h","m","split","map","Number","isNaN","cssVars","s","toNum","v","d","String","concat","QueryObserver","_client","WeakMap","_currentQuery","_currentQueryInitialState","_currentResult","_currentResultState","_currentResultOptions","_currentThenable","_selectError","_selectFn","_selectResult","_lastQueryWithDefinedData","_staleTimeoutId","_refetchIntervalId","_currentRefetchInterval","_trackedProps","_Class_brand","WeakSet","Subscribable","constructor","client","options","super","_classPrivateMethodInitSpec","_classPrivateFieldInitSpec","Set","_classPrivateFieldSet","this","pendingThenable","bindMethods","setOptions","refetch","bind","onSubscribe","listeners","size","_classPrivateFieldGet","addObserver","shouldFetchOnMount","_assertClassBrand","_executeFetch","call","updateResult","_updateTimers","onUnsubscribe","hasListeners","destroy","shouldFetchOnReconnect","shouldFetchOn","refetchOnReconnect","shouldFetchOnWindowFocus","refetchOnWindowFocus","_clearStaleTimeout","_clearRefetchInterval","removeObserver","prevOptions","prevQuery","defaultQueryOptions","enabled","resolveEnabled","Error","_updateQuery","_defaulted","shallowEqualObjects","getQueryCache","notify","type","query","observer","mounted","shouldFetchOptionally","resolveStaleTime","staleTime","_updateStaleTimeout","nextRefetchInterval","_computeRefetchInterval","_updateRefetchInterval","getOptimisticResult","build","result","createResult","optimisticResult","getCurrentResult","shouldAssignObserverCurrentProperties","state","trackResult","onPropTracked","Proxy","get","target","key","trackProp","experimental_prefetchInRender","status","reject","Reflect","add","getCurrentQuery","_ref","arguments","length","undefined","Object","assign","TypeError","_objectDestructuringEmpty","fetch","_objectSpread","fetchOptimistic","defaultedOptions","then","fetchOptions","_fetchOptions$cancelR","cancelRefetch","prevResult","prevResultState","prevResultOptions","queryInitialState","data","newState","isPlaceholderData","_optimisticResults","fetchOnMount","fetchOptionally","fetchState","fetchStatus","error","errorUpdatedAt","skipSelect","placeholderData","_classPrivateFieldGet2","replaceData","select","selectError","Date","now","isFetching","isPending","isError","isLoading","hasData","nextResult","isSuccess","isInitialLoading","dataUpdatedAt","failureCount","fetchFailureCount","failureReason","fetchFailureReason","errorUpdateCount","isFetched","dataUpdateCount","isFetchedAfterMount","isRefetching","isLoadingError","isPaused","isRefetchError","isStale","promise","isEnabled","finalizeThenableIfPossible","thenable","resolve","recreateThenable","pending","prevThenable","queryHash","value","reason","_notify","shouldNotifyListeners","notifyOnChangeProps","notifyOnChangePropsValue","includedProps","throwOnError","keys","some","typedKey","has","onQueryUpdate","catch","noop","isServer","isValidTimeout","timeout","timeUntilStale","timeoutManager","setTimeout","_ref2","refetchInterval","nextInterval","setInterval","refetchIntervalInBackground","focusManager","isFocused","clearTimeout","clearInterval","notifyOptions","notifyManager","batch","forEach","listener","retryOnMount","shouldLoadOnMount","refetchOnMount","field","suspense","isStaleByTime","createValue","isReset","clearReset","reset","QueryErrorResetBoundaryContext","React","IsRestoringContext","Provider","errorResetBoundary","useBaseQuery","Observer","queryClient","_client$getDefaultOpt","_client$getDefaultOpt2","_client$getDefaultOpt3","_client$getDefaultOpt4","isRestoring","useQueryClient","getDefaultOptions","queries","_experimental_beforeQuery","MIN_SUSPENSE_TIME_MS","clamp","Math","max","originalStaleTime","gcTime","ensureSuspenseTimers","ensurePreventErrorBoundaryRetry","useClearResetErrorBoundary","isNewCacheEntry","shouldSubscribe","subscribed","onStoreChange","unsubscribe","subscribe","batchCalls","shouldSuspend","shouldThrowError","getHasError","_experimental_afterQuery","willFetch","_client$getQueryCache","finally","useQuery","useAuth","qc","token","window","localStorage","getItem","me","queryKey","queryFn","async","API","jwt","payload","JSON","parse","atob","replace","_unused","decodeJwt","user","role","invalidateQueries","DAYS_7","getMonday","date","setHours","day","getDay","diff","setDate","getDate","addDays","n","sameDay","a","b","getFullYear","getMonth","ymd","y","padStart","dd","parseTimeFlexible","_timeToMin","includes","getHours","getMinutes","palette","bg","border","textColorsForBg","bgHex","rgb","hex","c","full","ch","join","r","parseInt","slice","g","hexToRgb","text","muted","shadow","computeLayout","items","startMin","endMin","monday","byDay","reduce","acc","it","dname","item","startDate","i","dayNameOf","push","arr","sMin","startHour","start","eMin","endHour","end","min","filter","sort","active","clusterId","usedCols","clusters","Map","out","currentStart","x","delete","_col","clear","col","maxCols","set","pal","charCodeAt","colorForKey","title","subject","color","borderColor","top","height","style","backgroundColor","textColor","mutedColor","textShadow","maxColsByCluster","fromEntries","entries","cols","width","left","startOfMonth","addMonths","setMonth","parseDateLike","getTime","eventDateRange","ev","e","endDate","eachDay","absUrl","u","_API$defaults","test","startsWith","defaults","baseURL","formatRange","fmt","toLocaleDateString","month","_settings$schedule","_timeToMin2","_settings$schedule2","_settings$ui$pxPerMin","_settings$ui","_settings$schedule$sh","_settings$schedule3","refetchMe","view","setView","useState","setMonday","monthRef","setMonthRef","setItems","err","setErr","page","setPage","isAdmin","clubs","setClubs","form","setForm","location","imageUrl","description","clubId","basePxPerMin","zoom","setZoom","eventsScrollRef","useRef","isPanningRef","panStartRef","from","to","clubFilter","setClubFilter","pinnedEvents","setPinnedEvents","subscribedEvents","setSubscribedEvents","useEffect","eventsResp","loadingEvents","limit","club","params","URLSearchParams","toString","Array","isArray","total","pages","fetchClubs","layout","useMemo","weekDays","_","nowMin","showNow","monthStart","gridStart","mondayBefore","monthDays","eventsByDay","range","k","onMouseMove","current","dx","clientX","dy","clientY","scrollLeft","scrollTop","onMouseUp","cursor","removeEventListener","onChange","f","name","isFollowed","id","toggleFollow","followed","Promise","all","post","_unused2","_jsxs","className","children","display","alignItems","gap","justifyContent","marginBottom","_jsx","margin","year","onClick","prev","next","flexWrap","padding","_id","clubName","disabled","p","onSubmit","preventDefault","trim","list","e2","_e2$response","_e2$response$data","response","gridTemplateColumns","required","flexDirection","MediaUpload","onUploaded","absoluteUrl","url","loading","src","alt","borderRadius","gridColumn","ref","onWheel","container","rect","getBoundingClientRect","pointerY","old","nextZ","deltaY","newScrollTop","requestAnimationFrame","onMouseDown","addEventListener","floor","mm","idx","_layout$d","dayDate","slot","backgroundImage","backgroundSize","backgroundPosition","fontSize","_e2$response2","_e2$response2$data","deleteEvent","background","wd","isOther","isToday","visible","more","_ev$style","flex","overflow","textOverflow","lineHeight","showPreview","previewSize","file","setFile","setStatus","preview","setPreview","inputRef","accept","_e$target$files","files","URL","createObjectURL","objectFit","_e$preventDefault","fd","FormData","append","_API$defaults$baseURL","headers","base","msg"],"sourceRoot":""}