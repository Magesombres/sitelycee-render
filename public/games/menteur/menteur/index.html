<!doctype html>
<html lang="fr">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Menteur (cartes) — Variante rang fixe et exigence croissante</title>
    <link rel="stylesheet" href="./styles.css" />
  </head>
  <body>
    <div id="app">
      <!-- Écran de démarrage -->
      <section id="start-screen" class="screen">
        <div class="panel">
          <h1>Menteur — Liar Game</h1>
          <p class="subtitle">Variante: 1 visible pour démarrer, puis +1 face cachée, même figure, accusation par le joueur suivant uniquement.</p>

          <form id="setup-form">
            <div class="form-row">
              <label for="numPlayers">Nombre de joueurs (2–8)</label>
              <input id="numPlayers" name="numPlayers" type="number" min="2" max="8" value="4" required aria-describedby="numPlayersHelp" />
              <div id="numPlayersHelp" class="hints">Auto: 1 paquet ≤4 joueurs, sinon 2 paquets.</div>
            </div>

            <div id="players-config"></div>

            <div class="form-row inline">
              <div>
                <label>Paquets utilisés</label>
                <div id="packs-info">Auto: 1 paquet pour ≤4 joueurs, 2 paquets pour 5–8.</div>
              </div>
              <div>
                <label>Exigence (borne max)</label>
                <div id="cap-info">Auto: 10 par paquet (8 de la figure + 2 Jokers).</div>
              </div>
            </div>

            <button type="submit" class="primary">Démarrer</button>
          </form>
        </div>
      </section>

      <!-- Écran de jeu -->
      <section id="game-screen" class="screen hidden">
        <header class="topbar">
          <div class="status">
            <span>Manche: <strong id="round-rank">—</strong></span>
            <span>Exigence: <strong id="requirement">1</strong></span>
            <span>Cap: <strong id="cap"></strong></span>
            <span>Pioche centrale: <strong id="pile-count">0</strong></span>
            <span>Réserve: <strong id="reserve-count">0</strong></span>
          </div>
          <div class="players-line" id="players-line"></div>
        </header>

  <div id="step-banner" class="step-banner"></div>

        <main class="play-area">
          <div class="current-player">
            <h2 id="current-player-name">Joueur</h2>
            <div id="hand" class="hand"></div>

            <div id="lead-controls" class="controls hidden">
              <h3>Ouverture de manche</h3>
              <p>Choisissez une carte à poser face visible et l'annonce (figure revendiquée).</p>
              <div class="selection" id="lead-selection"></div>
              <div class="announce-rank-picker" id="announce-rank-picker">
                <label for="announce-rank">Annonce:</label>
                <select id="announce-rank">
                  <option value="Roi">Roi</option>
                  <option value="Dame">Dame</option>
                  <option value="Valet">Valet</option>
                  <option value="As">As</option>
                </select>
              </div>
              <button id="btn-lead-play" class="primary" disabled>Poser la carte</button>
            </div>

            <div id="turn-controls" class="controls hidden">
              <h3>Votre pose <span id="turn-requirement-label"></span> cartes face cachée</h3>
              <p>Choisissez l'annonce (figure revendiquée). Les Jokers comptent comme la figure annoncée.</p>
              <div class="announce-rank-picker" id="turn-announce-rank-picker">
                <label for="turn-announce-rank">Annonce:</label>
                <select id="turn-announce-rank">
                  <option value="Roi">Roi</option>
                  <option value="Dame">Dame</option>
                  <option value="Valet">Valet</option>
                  <option value="As">As</option>
                </select>
              </div>
              <div class="quick-actions">
                <button id="btn-autofill" class="secondary">Remplir avec l’annonce</button>
                <button id="btn-clear-selection" class="secondary">Vider la sélection</button>
              </div>
              <div class="selection-grid" id="turn-selection-grid"></div>
              <div class="selection-summary">
                Sélection: <strong id="turn-selected-count">0</strong> / <span id="turn-need-count"></span>
                • Conformes: <strong id="count-matching">0</strong>
                • Autres: <strong id="count-nonmatching">0</strong>
              </div>
              <button id="btn-turn-play" class="primary" disabled>Poser les cartes</button>
            </div>

            <div id="action-hints" class="hints"></div>
          </div>
          
          <div class="table-area" id="table-area">
            <h3>Table</h3>
            <div class="table-surface">
              <div class="table-info-line">
                <span>Annonce: <strong id="table-rank">—</strong></span>
                <span>Cartes sur table: <strong id="table-count">0</strong></span>
              </div>
              <div class="table-stacks">
                <div class="visible-slot" id="table-visible"></div>
                <div class="face-down-stack" id="table-facedown"></div>
              </div>
            </div>
          </div>

          <aside class="last-play" id="last-play">
            <h3>Dernière pose</h3>
            <div id="last-play-content">Aucune</div>
          </aside>
        </main>
      </section>

      <!-- Overlays -->
      <div id="overlay" class="overlay hidden"></div>

      <div id="pass-device" class="modal hidden">
        <div class="modal-body">
          <h3>Passer l'appareil</h3>
          <p>Au tour de: <strong id="next-player-name"></strong></p>
          <button id="btn-ready" class="primary">Je suis prêt</button>
        </div>
      </div>

      <div id="accuse-modal" class="modal hidden">
        <div class="modal-body">
          <h3>Accuser <strong id="accused-name"></strong> ?</h3>
          <p>Annonce: <strong id="accuse-rank"></strong> • Cartes posées: <strong id="accuse-count"></strong></p>
          <div class="modal-actions">
            <button id="btn-accuse" class="danger">Menteur !</button>
            <button id="btn-let-pass" class="secondary">Laisser passer</button>
          </div>
          <p class="note" id="force-accuse-note" hidden>Exigence au-delà du cap. Accusation obligatoire.</p>
        </div>
      </div>

      <div id="reveal-modal" class="modal hidden">
        <div class="modal-body">
          <h3>Révélation</h3>
          <div id="reveal-details"></div>
          <button id="btn-continue-after-reveal" class="primary">Continuer</button>
        </div>
      </div>

      <div id="roulette-modal" class="modal hidden">
        <div class="modal-body">
          <h3>Roulette secrète</h3>
          <div id="roulette-details"></div>
          <div class="modal-actions">
            <button id="btn-roulette-continue" class="primary">Continuer</button>
          </div>
        </div>
      </div>

      <div id="winner-modal" class="modal hidden">
        <div class="modal-body">
          <h3>Victoire !</h3>
          <p>Gagnant: <strong id="winner-name"></strong></p>
          <div class="modal-actions">
            <button id="btn-new-round" class="secondary">Nouvelle manche (mêmes joueurs)</button>
            <button id="btn-restart" class="primary">Écran d'accueil</button>
          </div>
        </div>
      </div>
    </div>

    <script src="./app.js"></script>
  </body>
  </html>
